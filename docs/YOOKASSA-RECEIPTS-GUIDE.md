# Подключение онлайн-кассы в ЮKassa: инструкция

> Пошаговая инструкция для подключения фискальных чеков (54-ФЗ) в личном кабинете ЮKassa.
> После выполнения этих шагов передайте полученные данные разработчику для технической интеграции.

---

## Зачем это нужно

По закону 54-ФЗ каждая онлайн-продажа должна сопровождаться фискальным чеком, который автоматически отправляется в налоговую (ФНС). Без этого принимать платежи на сайте **нельзя** — грозят штрафы.

**Хорошая новость**: ЮKassa предлагает решение "Чеки от ЮKassa", которое берёт всё на себя. Вам **не нужно**:
- Покупать или арендовать онлайн-кассу
- Регистрировать кассу в налоговой
- Заключать договор с оператором фискальных данных (ОФД)
- Покупать фискальный накопитель

ЮKassa сама формирует чеки и отправляет их покупателю на email и в ФНС.

---

## Что нужно подготовить заранее

Перед тем как начать, убедитесь, что у вас есть:

- [ ] Доступ в [личный кабинет ЮKassa](https://yookassa.ru/my/)
- [ ] Информация о системе налогообложения ИП (уточните у бухгалтера, если не уверены)
- [ ] Email для получения уведомлений об ошибках чеков (например, support@symancy.ru)

### Вопрос бухгалтеру

Перед настройкой уточните у бухгалтера **два параметра**:

1. **Система налогообложения**: УСН (доходы)? УСН (доходы-расходы)? ОСН? Патент?
2. **Ставка НДС**: Без НДС? НДС 5%? НДС 20%? НДС 22%?

> Скорее всего, если ИП на УСН с доходами до 60 млн руб./год — это **УСН (доходы)** и **Без НДС**.

---

## Шаг 1. Войти в личный кабинет ЮKassa

1. Откройте https://yookassa.ru/my/
2. Войдите с учётными данными вашего магазина
3. Убедитесь, что вы находитесь в нужном магазине (тестовом или боевом — в зависимости от этапа)

---

## Шаг 2. Включить "Чеки от ЮKassa"

1. В меню слева найдите раздел **"Настройки"** → **"Онлайн-касса"** (или "Чеки для налоговой" / "54-ФЗ")
2. Нажмите **"Подключить"** или подтвердите, что вам нужно отправлять чеки
3. Выберите вариант: **"Чеки от ЮKassa"** (а не "Сторонняя онлайн-касса")

> Если не можете найти этот раздел — обратитесь в поддержку ЮKassa (чат в правом нижнем углу личного кабинета или email merchants@yookassa.ru) и попросите включить "Чеки от ЮKassa" для вашего магазина.

---

## Шаг 3. Заполнить настройки чеков

После включения вам предложат заполнить параметры:

| Поле | Что указать |
|------|-------------|
| **Система налогообложения** | То, что подтвердил бухгалтер. Скорее всего: **УСН (доходы)** |
| **Адрес расчёта** (место расчёта / URL сайта) | `https://symancy.ru` |
| **Email для уведомлений об ошибках** | `support@symancy.ru` (или ваш личный email) |

### Настройка связи платежа и чека

Вам предложат выбрать один из вариантов:

- **"Принять платёж"** — ЮKassa сначала принимает платёж, потом формирует чек ← **ВЫБРАТЬ ЭТОТ**
- "Отменить платёж" — если чек не прошёл, платёж отменяется
- "Не связывать" — чеки отправляются отдельно

**Выберите "Принять платёж"** — это стандартный вариант для нашего сценария.

---

## Шаг 4. Сохранить и подтвердить

1. Проверьте все введённые данные
2. Нажмите **"Сохранить"** или **"Подтвердить"**
3. Дождитесь подтверждения — обычно настройки применяются сразу

---

## Шаг 5. Настроить webhook (уведомления о платежах)

> Этот шаг может быть уже выполнен. Проверьте.

1. Перейдите в **"Интеграция"** → **"HTTP-уведомления"** (или "Webhooks")
2. Нажмите **"Добавить"** (если уведомления ещё не настроены)
3. Заполните:

| Поле | Значение |
|------|----------|
| **URL** | `https://johspxgvkbrysxhilmbg.supabase.co/functions/v1/payment-webhook` |
| **События** | Поставьте галочки на: **payment.succeeded** и **payment.canceled** |

4. Нажмите **"Сохранить"**

---

## Шаг 6. Получить API-ключи (если ещё не получены)

1. Перейдите в **"Интеграция"** → **"Ключи API"**
2. Скопируйте два значения:

```
shopId: _______________  (идентификатор магазина, например: 123456)
secretKey: _______________  (секретный ключ, начинается с test_ или live_)
```

---

## Шаг 7. Передать данные разработчику

После выполнения всех шагов отправьте разработчику следующую информацию:

```
1. Чеки от ЮKassa: включены? ДА / НЕТ
2. Система налогообложения: _______________
3. Ставка НДС: _______________
4. shopId: _______________
5. secretKey: _______________
6. Webhook настроен? ДА / НЕТ
```

> **Важно**: secretKey — секретный ключ. Передавайте его только лично или через защищённый канал (не в открытом чате/email).

---

## Переключение в боевой режим

Когда тестирование завершено и всё работает, нужно повторить настройку для **боевого магазина**:

1. В личном кабинете ЮKassa переключитесь на **боевой магазин** (вверху страницы есть переключатель "Тестовый магазин" / "Боевой магазин")
2. Повторите **шаги 2-6** для боевого магазина
3. Передайте разработчику **боевые** shopId и secretKey (они будут другими, secretKey начинается с `live_`)

---

## Если что-то не получается

### Поддержка ЮKassa

- **Чат**: правый нижний угол личного кабинета
- **Email**: merchants@yookassa.ru
- **Телефон**: 8 800 250-66-99 (бесплатно по России)

### Что спросить у поддержки

Если не можете найти нужный раздел или настройку, напишите в поддержку примерно следующее:

> Здравствуйте! Я хочу подключить "Чеки от ЮKassa" для соблюдения 54-ФЗ.
> Мой магазин: [номер shopId].
> Подскажите, как включить формирование фискальных чеков через ваше решение?
> Мы ИП на УСН, принимаем платежи за цифровые услуги на сайте.

---

## Краткий итог: что нужно сделать

| # | Действие | Кто делает | Статус |
|---|----------|------------|--------|
| 1 | Уточнить систему налогообложения и НДС у бухгалтера | Анна + бухгалтер | |
| 2 | Включить "Чеки от ЮKassa" в тестовом магазине | Анна | |
| 3 | Заполнить настройки чеков (СНО, адрес, email) | Анна | |
| 4 | Настроить webhook (если не настроен) | Анна | |
| 5 | Передать данные разработчику | Анна → Игорь | |
| 6 | Разработчик внесёт изменения в код и задеплоит | Игорь | |
| 7 | Протестировать в тестовом режиме | Игорь + Анна | |
| 8 | Повторить шаги 2-5 для боевого магазина | Анна | |
| 9 | Провести тестовый реальный платёж (100 руб.) | Игорь + Анна | |
| 10 | Проверить, что чек пришёл на email | Анна | |
