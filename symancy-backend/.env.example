# =============================================================================
# Symancy Backend Environment Variables
# =============================================================================
# Copy this file to .env and fill in the values
# =============================================================================

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------
NODE_ENV=development
PORT=3000
MODE=BOTH  # API | WORKER | BOTH

# -----------------------------------------------------------------------------
# Supabase
# -----------------------------------------------------------------------------
# Get from Supabase Dashboard -> Settings -> API
SUPABASE_URL=https://your-project-ref.supabase.co

# Get from Supabase Dashboard -> Settings -> API -> service_role (keep secret!)
SUPABASE_SERVICE_KEY=eyJ...

# Get from Supabase Dashboard -> Settings -> Database -> Connection string
# Use pooler URL for external connections (port 6543)
DATABASE_URL=postgres://postgres.[ref]:[password]@aws-0-eu-central-1.pooler.supabase.com:6543/postgres

# -----------------------------------------------------------------------------
# Telegram Bot
# -----------------------------------------------------------------------------
# Get from @BotFather on Telegram
TELEGRAM_BOT_TOKEN=123456:ABC...

# Random secret string for webhook verification (min 16 chars)
TELEGRAM_WEBHOOK_SECRET=your-random-secret-min-16-chars

# -----------------------------------------------------------------------------
# OpenRouter (LLM API)
# -----------------------------------------------------------------------------
# Get from https://openrouter.ai/keys
OPENROUTER_API_KEY=sk-or-...

# -----------------------------------------------------------------------------
# Optional Settings
# -----------------------------------------------------------------------------
# Logging level: trace | debug | info | warn | error | fatal
LOG_LEVEL=debug

# Your Telegram user ID for admin alerts
ADMIN_CHAT_ID=123456789

# Photo storage path (default: ./data/photos)
PHOTO_STORAGE_PATH=/var/data/symancy/photos

# Database pool settings (defaults usually work fine)
# DB_POOL_MAX=20
# DB_POOL_IDLE_TIMEOUT_MS=30000
# DB_POOL_CONNECTION_TIMEOUT_MS=2000

# -----------------------------------------------------------------------------
# Omnichannel Authentication (for Telegram Login Widget / WebApp)
# -----------------------------------------------------------------------------
# At least one of these must be set:
#
# OPTION 1 (Recommended): RS256 Asymmetric Key (new Supabase format)
# Get from Supabase Dashboard -> Settings -> API -> JWT Signing Keys
# Click "Start using JWT signing keys", then copy the private key
# The key should be in PEM format (starts with -----BEGIN PRIVATE KEY-----)
# SUPABASE_JWT_SIGNING_KEY="-----BEGIN PRIVATE KEY-----\nMIIE...\n-----END PRIVATE KEY-----"
#
# OPTION 2 (Legacy): HS256 Symmetric Secret
# Get from Supabase Dashboard -> Settings -> API -> JWT Secret
SUPABASE_JWT_SECRET=your-jwt-secret-from-supabase-dashboard

# Frontend URL for redirects and CORS
FRONTEND_URL=https://symancy.ru

# WebApp URL for Telegram Mini App button (opens in Telegram)
# If set, adds a "Symancy" button to bot menu that opens the Mini App
WEBAPP_URL=https://symancy.ru
